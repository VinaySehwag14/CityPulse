(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{63:(t,e,s)=>{"use strict";var i=s(7260);s.o(i,"useParams")&&s.d(e,{useParams:function(){return i.useParams}}),s.o(i,"usePathname")&&s.d(e,{usePathname:function(){return i.usePathname}}),s.o(i,"useRouter")&&s.d(e,{useRouter:function(){return i.useRouter}}),s.o(i,"useSelectedLayoutSegments")&&s.d(e,{useSelectedLayoutSegments:function(){return i.useSelectedLayoutSegments}})},549:(t,e,s)=>{"use strict";s.d(e,{n:()=>l});var i=s(2115),r=s(8559),a=s(4268),n=s(8445),o=s(4049),u=class extends n.Q{#t;#e=void 0;#s;#i;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,o.f8)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,o.EN)(e.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#r(),this.#a(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#r(),this.#a()}mutate(t,e){return this.#i=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#r(){let t=this.#s?.state??(0,r.$)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#a(t){a.jG.batch(()=>{if(this.#i&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context,i={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#i.onSuccess?.(t.data,e,s,i)}catch(t){Promise.reject(t)}try{this.#i.onSettled?.(t.data,null,e,s,i)}catch(t){Promise.reject(t)}}else if(t?.type==="error"){try{this.#i.onError?.(t.error,e,s,i)}catch(t){Promise.reject(t)}try{this.#i.onSettled?.(void 0,t.error,e,s,i)}catch(t){Promise.reject(t)}}}this.listeners.forEach(t=>{t(this.#e)})})}},c=s(9776);function l(t,e){let s=(0,c.jE)(e),[r]=i.useState(()=>new u(s,t));i.useEffect(()=>{r.setOptions(t)},[r,t]);let n=i.useSyncExternalStore(i.useCallback(t=>r.subscribe(a.jG.batchCalls(t)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=i.useCallback((t,e)=>{r.mutate(t,e).catch(o.lQ)},[r]);if(n.error&&(0,o.GU)(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}},667:(t,e,s)=>{"use strict";s.d(e,{A:()=>o});var i=s(5155),r=s(2821);let a={primary:"bg-[#0caee8] text-white hover:bg-[#0090c6] active:scale-[0.97]",secondary:"bg-[#1c2128] text-[#e6edf3] border border-[#30363d] hover:bg-[#252b33] active:scale-[0.97]",ghost:"text-[#8b949e] hover:text-[#e6edf3] hover:bg-[#1c2128]",danger:"bg-red-500/10 text-red-400 border border-red-500/30 hover:bg-red-500/20"},n={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};function o(t){let{variant:e="primary",size:s="md",loading:o=!1,className:u,children:c,disabled:l,...h}=t;return(0,i.jsxs)("button",{className:(0,r.$)("inline-flex items-center justify-center gap-2 font-medium rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#0caee8]",a[e],n[s],u),disabled:l||o,...h,children:[o&&(0,i.jsx)("span",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),c]})}},1715:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>u});var i=s(5155),r=s(2115),a=s(63),n=s(4e3),o=s(667);function u(){let t=(0,a.useRouter)(),e=(0,n.W0)(),[s,u]=(0,r.useState)({title:"",description:"",lat:"",lng:"",start_time:"",end_time:""}),[c,l]=(0,r.useState)(""),h=(t,e)=>u(s=>({...s,[t]:e})),d=async i=>{i.preventDefault(),l("");let r=parseFloat(s.lat),a=parseFloat(s.lng);if(!s.title.trim())return l("Title is required");if(isNaN(r)||isNaN(a))return l("Valid latitude and longitude are required");if(!s.start_time||!s.end_time)return l("Start and end times are required");if(new Date(s.end_time)<=new Date(s.start_time))return l("End time must be after start time");try{let i=await e.mutateAsync({title:s.title.trim(),description:s.description.trim()||void 0,lat:r,lng:a,start_time:new Date(s.start_time).toISOString(),end_time:new Date(s.end_time).toISOString()});t.push("/events/".concat(i.id))}catch(t){l(t instanceof Error?t.message:"Failed to create event")}},m="w-full bg-[#1c2128] border border-[#30363d] rounded-xl px-3 py-2.5 text-sm text-[#e6edf3] placeholder-[#8b949e] focus:outline-none focus:border-[#0caee8] transition-colors",p="block text-sm font-medium text-[#e6edf3] mb-1.5";return(0,i.jsxs)("div",{className:"max-w-xl mx-auto px-4 py-8",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gradient",children:"Create Event"}),(0,i.jsx)("p",{className:"text-[#8b949e] text-sm mt-1",children:"Share what's happening in your city"})]}),(0,i.jsxs)("form",{onSubmit:d,className:"space-y-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"title",className:p,children:"Event Title *"}),(0,i.jsx)("input",{id:"title",required:!0,placeholder:"What's happening?",value:s.title,onChange:t=>h("title",t.target.value),className:m,maxLength:200})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"description",className:p,children:"Description"}),(0,i.jsx)("textarea",{id:"description",placeholder:"Tell people more about this eventâ€¦",value:s.description,onChange:t=>h("description",t.target.value),rows:3,className:"".concat(m," resize-none"),maxLength:2e3})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"lat",className:p,children:"Latitude *"}),(0,i.jsx)("input",{id:"lat",type:"number",step:"any",placeholder:"28.6139",value:s.lat,onChange:t=>h("lat",t.target.value),className:m,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"lng",className:p,children:"Longitude *"}),(0,i.jsx)("input",{id:"lng",type:"number",step:"any",placeholder:"77.2090",value:s.lng,onChange:t=>h("lng",t.target.value),className:m,required:!0})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start_time",className:p,children:"Start Time *"}),(0,i.jsx)("input",{id:"start_time",type:"datetime-local",value:s.start_time,onChange:t=>h("start_time",t.target.value),className:m,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end_time",className:p,children:"End Time *"}),(0,i.jsx)("input",{id:"end_time",type:"datetime-local",value:s.end_time,onChange:t=>h("end_time",t.target.value),className:m,required:!0})]})]}),c&&(0,i.jsx)("p",{className:"text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded-xl px-3 py-2",children:c}),(0,i.jsx)(o.A,{type:"submit",size:"lg",loading:e.isPending,className:"w-full mt-2",children:"Publish Event"})]})]})}},2327:(t,e,s)=>{"use strict";s.d(e,{$P:()=>u,Vg:()=>o});var i=s(5125);let r="http://localhost:4000/api",a=i.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});function n(t){return i.A.create({baseURL:r,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})}async function o(t,e){let s=e?n(e):a,i=await s.get(t);if(!i.data.success||void 0===i.data.data){var r;throw Error(null!=(r=i.data.error)?r:"Unknown error")}return i.data.data}async function u(t,e,s){let i=n(s),r=await i.post(t,e);if(!r.data.success||void 0===r.data.data){var a;throw Error(null!=(a=r.data.error)?a:"Unknown error")}return r.data.data}},3455:(t,e,s)=>{"use strict";s.d(e,{I:()=>a});var i=s(2954),r=s(4774);function a(t,e){return(0,r.t)(t,i.$,e)}},4e3:(t,e,s)=>{"use strict";s.d(e,{W0:()=>c,_q:()=>u});var i=s(3455),r=s(9776),a=s(549),n=s(7471),o=s(2327);function u(t){return(0,i.I)({queryKey:["event",t],queryFn:()=>(0,o.Vg)("/events/".concat(t)),enabled:!!t})}function c(){let{getToken:t}=(0,n.d)(),e=(0,r.jE)();return(0,a.n)({mutationFn:async e=>{let s=await t();return(0,o.$P)("/events",e,s)},onSuccess:()=>{e.invalidateQueries({queryKey:["feed"]})}})}},4206:(t,e,s)=>{Promise.resolve().then(s.bind(s,1715))},7471:(t,e,s)=>{"use strict";s.d(e,{PromisifiedAuthProvider:()=>u,d:()=>c});var i=s(4018),r=s(633),a=s(9268),n=s(2115);let o=n.createContext(null);function u(t){let{authPromise:e,children:s}=t;return n.createElement(o.Provider,{value:e},s)}function c(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,a.useRouter)(),s=n.useContext(o),u=s;return(s&&"then"in s&&(u=n.use(s)),"undefined"!=typeof window)?(0,i.As)({...u,...t}):e?(0,i.As)(t):(0,r.hP)({...u,...t})}},8559:(t,e,s)=>{"use strict";s.d(e,{$:()=>o,s:()=>n});var i=s(4268),r=s(2162),a=s(3049),n=class extends r.k{#t;#n;#o;#u;constructor(t){super(),this.#t=t.client,this.mutationId=t.mutationId,this.#o=t.mutationCache,this.#n=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#n.includes(t)||(this.#n.push(t),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#n=this.#n.filter(e=>e!==t),this.scheduleGc(),this.#o.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#n.length||("pending"===this.state.status?this.scheduleGc():this.#o.remove(this))}continue(){return this.#u?.continue()??this.execute(this.state.variables)}async execute(t){let e=()=>{this.#c({type:"continue"})},s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#u=(0,a.II)({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#c({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#c({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#o.canRun(this)});let i="pending"===this.state.status,r=!this.#u.canStart();try{if(i)e();else{this.#c({type:"pending",variables:t,isPaused:r}),this.#o.config.onMutate&&await this.#o.config.onMutate(t,this,s);let e=await this.options.onMutate?.(t,s);e!==this.state.context&&this.#c({type:"pending",context:e,variables:t,isPaused:r})}let a=await this.#u.start();return await this.#o.config.onSuccess?.(a,t,this.state.context,this,s),await this.options.onSuccess?.(a,t,this.state.context,s),await this.#o.config.onSettled?.(a,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(a,null,t,this.state.context,s),this.#c({type:"success",data:a}),a}catch(e){try{await this.#o.config.onError?.(e,t,this.state.context,this,s)}catch(t){Promise.reject(t)}try{await this.options.onError?.(e,t,this.state.context,s)}catch(t){Promise.reject(t)}try{await this.#o.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this,s)}catch(t){Promise.reject(t)}try{await this.options.onSettled?.(void 0,e,t,this.state.context,s)}catch(t){Promise.reject(t)}throw this.#c({type:"error",error:e}),e}finally{this.#o.runNext(this)}}#c(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),i.jG.batch(()=>{this.#n.forEach(e=>{e.onMutationUpdate(t)}),this.#o.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}}},t=>{t.O(0,[987,311,235,441,255,358],()=>t(t.s=4206)),_N_E=t.O()}]);